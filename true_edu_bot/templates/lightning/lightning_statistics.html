{% extends 'admin/base.html' %}

{% block content %}
<h2 style="text-align: center;">Статистика Молний</h2>

<!-- Выбор молнии -->
<form method="get" style="text-align: center; margin-bottom: 20px;">
    <select name="lightning_id" onchange="this.form.submit()">
        <option value="">Выберите Молнию</option>
        {% for lightning in lightnings %}
        <option value="{{ lightning.id }}" {% if lightning == selected_lightning %}selected{% endif %}>{{ lightning.title }}</option>
        {% endfor %}
    </select>
</form>

<!-- Статистика -->
<table class="table">
    <tr><td>Общее количество участников</td><td><a href="?lightning_id={{ selected_lightning.id }}&user_filter=all">{{ total_participants }}</a></td></tr>
    <tr><td>Количество ознакомленных</td><td><a href="?lightning_id={{ selected_lightning.id }}&user_filter=read">{{ read_count }}</a></td></tr>
    <tr><td>Количество не ознакомленных</td><td><a href="?lightning_id={{ selected_lightning.id }}&user_filter=not_read">{{ not_read_count }}</a></td></tr>
    <tr><td>Количество сдавших тест</td><td><a href="?lightning_id={{ selected_lightning.id }}&user_filter=completed_tests">{{ completed_tests }}</a></td></tr>
    <tr><td>Количество не сдавших тест</td><td><a href="?lightning_id={{ selected_lightning.id }}&user_filter=not_completed_tests">{{ not_completed_tests }}</a></td></tr>
</table>

<!-- Таблица пользователей -->
{% if user_list %}
<h3>Список пользователей</h3>
<table class="table">
    <thead>
        <tr>
            <th>ФИО</th>
            <th>Телефон</th>
            <th>Должность</th>
            <th>Подразделение</th>
        </tr>
    </thead>
    <tbody>
        {% for user in user_list %}
        <tr>
            <td>{{ user.full_name }}</td>
            <td>{{ user.phone }}</td>
            <td>{{ user.job_title }}</td>
            <td>{{ user.department }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% endif %}
{% endblock %}
